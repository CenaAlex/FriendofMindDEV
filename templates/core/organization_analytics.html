{% extends 'base.html' %}
{% load core_filters %}

{% block title %}Organization Analytics - FriendofMind{% endblock %}

{% block content %}
<div class="min-h-screen -mt-16 pt-16 bg-gradient-to-br from-primary via-secondary to-primary">
    <div class="max-w-8xl mx-auto px-16 sm:px-20 lg:px-24 py-8">

        <!-- Header -->
        <div class="mb-8">
            <h1 class="text-4xl font-bold text-white mb-2">Organization Analytics</h1>
            <p class="text-xl text-white opacity-90">
                Insights and analytics for your organization's mental health support services
            </p>
        </div>

        <!-- Analytics Overview -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg p-6 text-white">
                <div class="text-center">
                    <h3 class="text-3xl font-bold">{{ monthly_assessments|length }}</h3>
                    <p class="text-lg">Months Tracked</p>
                </div>
            </div>
            <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg p-6 text-white">
                <div class="text-center">
                    <h3 class="text-3xl font-bold">{{ assessment_types|length }}</h3>
                    <p class="text-lg">Assessment Types</p>
                </div>
            </div>
            <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg p-6 text-white">
                <div class="text-center">
                    <h3 class="text-3xl font-bold">{{ severity_levels|length }}</h3>
                    <p class="text-lg">Severity Levels</p>
                </div>
            </div>
            <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg p-6 text-white">
                <div class="text-center">
                    <h3 class="text-3xl font-bold">24/7</h3>
                    <p class="text-lg">Support Available</p>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Monthly Assessment Trends -->
            <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg shadow-lg p-8">
                <h2 class="text-2xl font-bold text-white mb-6">Monthly Assessment Trends</h2>
                {% if monthly_assessments %}
                    <div class="space-y-4">
                        {% for month, count in monthly_assessments.items %}
                        <div class="flex items-center justify-between">
                            <span class="text-white font-medium">{{ month }}</span>
                            <div class="flex items-center space-x-3">
                                <div class="w-32 bg-gray-300 rounded-full h-2">
                                    <div class="bg-[#304758] h-2 rounded-full" style="width: {% widthratio count 50 100 %}%"></div>
                                </div>
                                <span class="text-white text-sm w-8">{{ count }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center text-gray-300 py-8">
                        <i class="fas fa-chart-line text-4xl mb-4"></i>
                        <p>No assessment data available</p>
                    </div>
                {% endif %}
            </div>

            <!-- Assessment Type Distribution -->
            <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg shadow-lg p-8">
                <h2 class="text-2xl font-bold text-white mb-6">Assessment Type Distribution</h2>
                {% if assessment_types %}
                    <div class="space-y-4">
                        {% for type, count in assessment_types.items %}
                        <div class="flex items-center justify-between">
                            <span class="text-white font-medium">{{ type|title }}</span>
                            <div class="flex items-center space-x-3">
                                <div class="w-32 bg-gray-300 rounded-full h-2">
                                    <div class="bg-secondary h-2 rounded-full" style="width: {% widthratio count 100 100 %}%"></div>
                                </div>
                                <span class="text-white text-sm w-8">{{ count }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center text-gray-300 py-8">
                        <i class="fas fa-chart-pie text-4xl mb-4"></i>
                        <p>No assessment type data available</p>
                    </div>
                {% endif %}
            </div>

            <!-- Severity Level Distribution -->
            <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg shadow-lg p-8">
                <h2 class="text-2xl font-bold text-white mb-6">Severity Level Distribution</h2>
                {% if severity_levels %}
                    <div class="space-y-4">
                        {% for level, count in severity_levels.items %}
                        <div class="flex items-center justify-between">
                            <span class="text-white font-medium">{{ level|underscore_to_space }}</span>
                            <div class="flex items-center space-x-3">
                                <div class="w-32 bg-gray-300 rounded-full h-2">
                                    <div class="h-2 rounded-full
                                        {% if level == 'severe' %}bg-red-500
                                        {% elif level == 'moderately_severe' %}bg-orange-500
                                        {% elif level == 'moderate' %}bg-yellow-500
                                        {% elif level == 'mild' %}bg-green-500
                                        {% else %}bg-blue-500{% endif %}" 
                                        style="width: {% widthratio count 50 100 %}%"></div>
                                </div>
                                <span class="text-white text-sm w-8">{{ count }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center text-gray-300 py-8">
                        <i class="fas fa-exclamation-triangle text-4xl mb-4"></i>
                        <p>No severity level data available</p>
                    </div>
                {% endif %}
            </div>

            <!-- Key Insights -->
            <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg shadow-lg p-8">
                <h2 class="text-2xl font-bold text-white mb-6">Key Insights</h2>
                <div class="space-y-4">
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex items-start">
                            <i class="fas fa-chart-line text-blue-400 text-xl mr-3 mt-1"></i>
                            <div>
                                <h3 class="text-white font-semibold">Assessment Trends</h3>
                                <p class="text-gray-200 text-sm">Monitor the number of assessments completed over time to identify patterns and peak usage periods.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex items-start">
                            <i class="fas fa-users text-green-400 text-xl mr-3 mt-1"></i>
                            <div>
                                <h3 class="text-white font-semibold">User Engagement</h3>
                                <p class="text-gray-200 text-sm">Track which assessment types are most popular to better understand user needs and preferences.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex items-start">
                            <i class="fas fa-exclamation-circle text-red-400 text-xl mr-3 mt-1"></i>
                            <div>
                                <h3 class="text-white font-semibold">Severity Monitoring</h3>
                                <p class="text-gray-200 text-sm">Keep track of severity levels to ensure appropriate resources are allocated for different cases.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex items-start">
                            <i class="fas fa-heart text-pink-400 text-xl mr-3 mt-1"></i>
                            <div>
                                <h3 class="text-white font-semibold">Mental Health Impact</h3>
                                <p class="text-gray-200 text-sm">Use these insights to improve your organization's mental health support services and resource allocation.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="mt-8 flex justify-center space-x-4">
            <a href="{% url 'core:organization_dashboard' %}" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition duration-300">
                <i class="fas fa-arrow-left mr-2"></i>Back to Dashboard
            </a>
            <button onclick="exportAnalytics()" class="bg-[#304758] hover:bg-[#1e2d3a] text-white px-6 py-3 rounded-lg font-medium transition duration-300">
                <i class="fas fa-download mr-2"></i>Export Data
            </button>
        </div>
    </div>
</div>

<script>
function exportAnalytics() {
    // TODO: Implement analytics export functionality
    alert('Analytics export functionality coming soon!');
}
</script>
{% endblock %}




